# ========== APP ENVIRONMENT ==========
ENV=dev
PORT=8000
LOG_LEVEL=INFO                                   # DEBUG, INFO, WARNING, ERROR
DEBUG=false                                      # Enable SQLAlchemy echo + verbose logs

# ========== DATABASE ==========
# Local Postgres (Docker or installed)
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/gst_itr_db

# ========== REDIS ==========
# Session cache, rate limiting, message queue
REDIS_URL=redis://localhost:6379/0

# ========== ADMIN / INTERNAL ==========
# Simple header auth for admin APIs (e.g., invoice seeding)
ADMIN_API_KEY=change_this_in_real_env
DEBUG_ADMIN_MSISDN=                              # WhatsApp number for debug messages
SESSION_IDLE_MINUTES=10                          # Session timeout (minutes)

# ========== WHATSAPP CLOUD API ==========
# Used when talking directly to Meta Cloud API (test or prod)
WHATSAPP_VERIFY_TOKEN=subashtondamanatigstitrtaxbot    # you define this
WHATSAPP_ACCESS_TOKEN=EAAL...your-token-here       # Meta temporary or permanent token
WHATSAPP_PHONE_NUMBER_ID=000000000000000                     # From Meta "API Setup" page
WHATSAPP_APP_SECRET=your_app_secret_here                     # App Secret for webhook signature verification

# ========== AISENSY (INDIA-FIRST WHATSAPP BSP) ==========
# Used when you want to send/receive via AiSensy instead of Cloud API
AISENSY_API_KEY=                           # From AiSensy dashboard
AISENSY_PROJECT_ID=                               # Optional / for campaigns if needed

# ========== SARVAM AI (SPEECH-TO-TEXT) ==========
SARVAM_API_KEY=                                   # From Sarvam dashboard
SARVAM_STT_URL=https://api.sarvam.ai              # Or specific STT endpoint if given

# ========== BHASHINI (GOVT TRANSLATION / ASR / TTS) ==========
BHASHINI_USER_ID=                                 # userID from Bhashini/ULCA portal
BHASHINI_ULCA_API_KEY=                            # ulcaApiKey from portal
BHASHINI_TRANSLATION_PIPELINE_ID=                 # chosen translation pipelineId
BHASHINI_PIPELINE_BASE_URL=https://meity-auth.ulcacontrib.org/ulca/apis
# Backward-compat aliases (used by some internal modules)
BHASHINI_API_KEY=                                # Alias for BHASHINI_ULCA_API_KEY
BHASHINI_TRANSLATION_URL=                        # Alias for BHASHINI_PIPELINE_BASE_URL

# ========== MASTERGST / WHITEBOOKS GST API ==========
# Sign up at https://whitebooks.in → Developers → get Client ID & Secret
# Sandbox: https://apisandbox.whitebooks.in  |  Production: https://api.mastergst.com
#
# GST API (OTP-based authentication)
MASTERGST_BASE_URL=https://apisandbox.whitebooks.in
MASTERGST_CLIENT_ID=                             # WhiteBooks Client ID
MASTERGST_CLIENT_SECRET=                         # WhiteBooks Client Secret
MASTERGST_EMAIL=you@example.com                  # WhiteBooks registration email (required on every API call)
MASTERGST_GST_USERNAME=                          # GST portal username (e.g. BVMKA for Karnataka sandbox)
MASTERGST_STATE_CD=                              # State code (e.g. "29" for Karnataka, "36" for Telangana)
MASTERGST_IP_ADDRESS=127.0.0.1                   # Client IP address
MASTERGST_OTP_DEFAULT=575757                     # Sandbox OTP (always accepted in sandbox)

# ========== MASTERGST e-INVOICE API ==========
# Uses username/password auth (NOT OTP).
# Has its own client_id/secret — leave blank to fall back to GST API credentials above.
MASTERGST_EINVOICE_BASE_URL=https://apisandbox.whitebooks.in
MASTERGST_EINVOICE_CLIENT_ID=                    # e-Invoice Client ID (blank = use GST API client_id)
MASTERGST_EINVOICE_CLIENT_SECRET=                # e-Invoice Client Secret (blank = use GST API client_secret)
MASTERGST_EINVOICE_USERNAME=                     # e-Invoice portal username (e.g. BVMGSP for sandbox)
MASTERGST_EINVOICE_PASSWORD=                     # e-Invoice portal password (e.g. Wbooks@0142 for sandbox)

# ========== MASTERGST e-WAYBILL API ==========
# Uses username/password auth (NOT OTP).
# Has its own client_id/secret — leave blank to fall back to GST API credentials above.
MASTERGST_EWAYBILL_BASE_URL=https://apisandbox.whitebooks.in
MASTERGST_EWAYBILL_CLIENT_ID=                    # e-WayBill Client ID (blank = use GST API client_id)
MASTERGST_EWAYBILL_CLIENT_SECRET=                # e-WayBill Client Secret (blank = use GST API client_secret)
MASTERGST_EWAYBILL_USERNAME=                     # e-WayBill portal username (e.g. BVMGSP for sandbox)
MASTERGST_EWAYBILL_PASSWORD=                     # e-WayBill portal password (e.g. Wbooks@0142 for sandbox)

# ========== ITR SANDBOX ==========
ITR_SANDBOX_BASE_URL=                            # ITR sandbox API base URL
ITR_SANDBOX_API_KEY=                             # ITR sandbox API key

# ========== OPENAI (NLP / LLM) ==========
# Powers NLP intent detection, LLM invoice parsing, conversational Tax Q&A,
# and AI-generated analytics insights.
OPENAI_API_KEY=sk-proj-your-key-here                         # From https://platform.openai.com/api-keys
OPENAI_MODEL=gpt-4o                              # Model for all LLM calls
OPENAI_TIMEOUT=30                                # HTTP timeout in seconds

# ========== CA DASHBOARD JWT ==========
# JWT secret for CA (Chartered Accountant) dashboard authentication.
# IMPORTANT: Change this to a long random string in production!
CA_JWT_SECRET=change-me-in-production            # openssl rand -hex 32
CA_JWT_ALGORITHM=HS256                           # JWT signing algorithm
CA_JWT_ACCESS_EXPIRE_MINUTES=30                  # Access token TTL
CA_JWT_REFRESH_EXPIRE_DAYS=7                     # Refresh token TTL

# ========== USER API JWT (MOBILE / WEB CLIENTS) ==========
# Separate JWT secret for end-user REST API authentication.
# IMPORTANT: Change this to a long random string in production!
USER_JWT_SECRET=change-me-user-jwt               # openssl rand -hex 32
USER_JWT_ACCESS_EXPIRE_MINUTES=60                # Access token TTL (minutes)
USER_JWT_REFRESH_EXPIRE_DAYS=30                  # Refresh token TTL (days)

# ========== OCR ==========
# Backend used for invoice text extraction before LLM fallback
OCR_BACKEND=tesseract                            # tesseract | google_vision (future)

# ========== ADMIN JWT ==========
# Separate JWT secret for admin REST API authentication.
# IMPORTANT: Change this to a long random string in production!
ADMIN_JWT_SECRET=change-me-admin-jwt             # openssl rand -hex 32
ADMIN_JWT_ACCESS_EXPIRE_MINUTES=480              # Admin token TTL (8 hours)

# ========== RAG / EMBEDDINGS ==========
# Powers the knowledge base Q&A system (pgvector + OpenAI embeddings)
EMBEDDING_MODEL=text-embedding-3-small           # OpenAI embedding model
EMBEDDING_DIMENSIONS=1536                        # Vector dimensions
RAG_TOP_K=5                                      # Top-K retrieval results
RAG_SIMILARITY_THRESHOLD=0.7                     # Minimum similarity for results
RAG_CHUNK_SIZE=500                               # Tokens per chunk
RAG_CHUNK_OVERLAP=50                             # Token overlap between chunks

# ========== ML RISK SCORING ==========
# ML-based risk assessment for GST compliance (RandomForest + SHAP)
ML_RISK_ENABLED=true                             # Enable ML risk scoring
ML_RISK_BLEND_WEIGHT=0.3                         # Blend weight (0=rule-only, 1=ML-only)
ML_RISK_MIN_SAMPLES=50                           # Cold-start threshold (fallback to rules)
ML_RISK_RETRAIN_THRESHOLD=20                     # New labels needed to trigger retrain
ML_RISK_N_ESTIMATORS=100                         # RandomForest number of trees
ML_RISK_MAX_DEPTH=5                              # RandomForest max tree depth
ML_RISK_SHAP_ENABLED=true                        # Enable SHAP explainability

# ========== SEGMENT GATING ==========
# Dynamic feature menus based on user business segment
SEGMENT_GATING_ENABLED=true                      # Enable segment-based feature gating
DEFAULT_SEGMENT=small                            # Default segment: small | medium | enterprise
SEGMENT_CACHE_TTL=3600                           # Segment cache TTL (seconds)

# ========== PROACTIVE NOTIFICATIONS ==========
# Deadline reminders, risk alerts, and status updates
NOTIFICATION_ENABLED=true                        # Enable proactive notifications
NOTIFICATION_CHECK_INTERVAL_SECONDS=3600         # Check interval (1 hour)
NOTIFICATION_REMINDER_DAYS=[7, 3, 1]             # Days before deadline to send reminders
NOTIFICATION_DAILY_SCHEDULE_HOUR=9               # Daily schedule hour (9 AM IST)

# ========== OTP / EMAIL ==========
# Email-based OTP for user verification (optional)
OTP_EMAIL_ENABLED=false                          # Enable OTP via email
OTP_SMTP_HOST=                                   # SMTP server (e.g. smtp.gmail.com)
OTP_SMTP_PORT=587                                # SMTP port
OTP_SMTP_USERNAME=                               # SMTP username
OTP_SMTP_PASSWORD=                               # SMTP password
OTP_SMTP_USE_TLS=true                            # Use TLS for SMTP
OTP_FROM_EMAIL=noreply@example.com               # Sender email address

# ========== DEMO MODE ==========
INVESTOR_DEMO_MODE=false                         # Enable demo mode (simulated data)